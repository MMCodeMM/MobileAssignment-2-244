<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>運動教學 - API 整合版</title>
    <!-- Ionic CDN -->
    <script
      type="module"
      src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.esm.js"
    ></script>
    <script
      nomodule
      src="https://cdn.jsdelivr.net/npm/@ionic/core/dist/ionic/ionic.js"
    ></script>
    <!-- 加上 style.css 連結 -->
    <link rel="stylesheet" href="./src/style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@ionic/core/css/ionic.bundle.css"
    />
  </head>
  <body>
    <ion-app>
      <!-- 用戶認證 Modal -->
      <ion-modal id="auth-modal" trigger="auth-trigger">
        <ion-header>
          <ion-toolbar>
            <ion-title id="auth-modal-title">登入</ion-title>
            <ion-buttons slot="end">
              <ion-button id="close-auth-modal">
                <ion-icon name="close"></ion-icon>
              </ion-button>
            </ion-buttons>
          </ion-toolbar>
        </ion-header>
        <ion-content class="ion-padding">
          <div id="auth-form">
            <ion-item>
              <ion-label position="floating">使用者名稱</ion-label>
              <ion-input id="username-input" type="text"></ion-input>
            </ion-item>
            <ion-item>
              <ion-label position="floating">密碼</ion-label>
              <ion-input id="password-input" type="password"></ion-input>
            </ion-item>
            <div class="auth-buttons">
              <ion-button id="login-btn" expand="block" fill="solid"
                >登入</ion-button
              >
              <ion-button id="signup-btn" expand="block" fill="outline"
                >註冊</ion-button
              >
            </div>
            <div
              id="auth-error"
              class="error-message"
              style="display: none"
            ></div>
          </div>
        </ion-content>
      </ion-modal>

      <!-- 主要界面 -->
      <ion-header>
        <ion-toolbar>
          <ion-title>運動教學</ion-title>
          <ion-buttons slot="end">
            <!-- 用戶狀態和認證按鈕 -->
            <div id="user-info" style="display: none">
              <span id="username-display"></span>
              <ion-button id="logout-btn" fill="clear" size="small"
                >登出</ion-button
              >
            </div>
            <ion-button id="auth-trigger" fill="clear">
              <ion-icon name="person"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>

        <!-- 搜尋和篩選 -->
        <div class="search-filter-section">
          <ion-searchbar
            id="search-bar"
            placeholder="搜尋運動教學..."
          ></ion-searchbar>
          <div class="filter-controls">
            <ion-item>
              <ion-select
                id="category-select"
                label="分類"
                interface="popover"
                placeholder="選擇分類"
              >
                <ion-select-option value="">全部</ion-select-option>
              </ion-select>
              <ion-select
                id="sort-select"
                label="排序"
                interface="popover"
                placeholder="排序方式"
              >
                <ion-select-option value="">預設</ion-select-option>
                <ion-select-option value="title">標題</ion-select-option>
                <ion-select-option value="level">難度</ion-select-option>
              </ion-select>
              <ion-button id="show-bookmarks-btn" fill="outline" size="small">
                <ion-icon name="bookmark"></ion-icon>
                收藏
              </ion-button>
              <ion-button id="reset-filters-btn" fill="clear" size="small"
                >重設</ion-button
              >
            </ion-item>
          </div>
        </div>
      </ion-header>

      <ion-content>
        <!-- 載入指示器 -->
        <div
          id="loading-indicator"
          class="loading-container"
          style="display: none"
        >
          <ion-spinner name="dots"></ion-spinner>
          <p>載入中...</p>
        </div>

        <!-- 錯誤訊息 -->
        <div id="error-message" class="error-container" style="display: none">
          <ion-icon name="warning"></ion-icon>
          <p id="error-text"></p>
          <ion-button id="retry-btn" fill="outline">重試</ion-button>
        </div>

        <!-- 清單容器 -->
        <div class="container">
          <ion-list id="exercises-list">
            <!-- 清單項目範本 (會被 cloneNode) -->
            <ion-item class="list-item exercise-template" style="display: none">
              <div class="item-content">
                <div class="item-header">
                  <div class="item-title">標題</div>
                  <ion-button class="bookmark-btn" fill="clear" size="small">
                    <ion-icon name="bookmark-outline"></ion-icon>
                  </ion-button>
                </div>
                <div class="item-details">
                  <div class="item-subtitle">難度等級</div>
                  <div class="item-category">分類</div>
                  <div class="item-duration">時長</div>
                  <div class="item-equipment">器材</div>
                </div>
                <div class="item-description">描述</div>
                <img
                  class="item-image"
                  alt=""
                  style="
                    max-width: 100%;
                    height: auto;
                    display: block;
                    margin-top: 0.5rem;
                  "
                />
                <video
                  class="item-video"
                  controls
                  style="max-width: 100%; display: block; margin-top: 0.5rem"
                ></video>
                <div class="tag-container">
                  <!-- 標籤會於 script 動態加入 -->
                </div>
              </div>
            </ion-item>
          </ion-list>
        </div>

        <!-- 載入更多按鈕 -->
        <div class="load-more-container">
          <ion-button
            id="load-more-btn"
            expand="block"
            fill="outline"
            style="display: none"
          >
            載入更多
          </ion-button>
          <div
            id="load-more-loading"
            style="display: none; text-align: center; padding: 20px"
          >
            <ion-spinner name="dots"></ion-spinner>
            <p>載入更多資料...</p>
          </div>
        </div>

        <!-- 無資料提示 -->
        <div
          id="no-data-message"
          class="no-data-container"
          style="display: none"
        >
          <ion-icon name="document-outline"></ion-icon>
          <p>沒有找到相關的運動教學資料</p>
        </div>
      </ion-content>
    </ion-app>

    <!-- 載入主要應用程式 -->
    <script type="module" src="./dist/main.js"></script>
  </body>
</html>
